<div class="content-block dx-card responsive-paddings">
  <dx-form id="form" [formData]="notas" [colCount]="1">

    <dxi-item class="buttons">
      <dx-button icon="undo" text="Voltar" [width]="136" (onClick)="voltar()">
      </dx-button>

      <dx-button icon="close" type="danger" text="Cancelar" [width]="136" (onClick)="cancelar()">
      </dx-button>

      <dx-button icon="check" type="success" text="Salvar" [width]="136" (onClick)="salvar()">
      </dx-button>
    </dxi-item>

    <dxi-item itemType="group" caption="Cadastro de Nota Fiscal">

      <div class="containerTextBox">
        <div class="autocomplete">
          <div class="autocomplete-input">
            <dxi-item dataField="nome do Cliente">
              <dx-autocomplete
                placeholder="Digite o nome para buscar o cliente..."
                [(value)]="clienteSalvo"
                [dataSource]="listaClientes"
                [searchExpr]="'nome'"
                [valueExpr]="'nome'"
                displayExpr="'nome'"
                (onValueChanged)="updateClientesInfo($event)"
                [width]="900">
              </dx-autocomplete>
            </dxi-item>


          </div>
        </div>

        <div class="dateBox">
          <dxi-item dataField="data de Emissão">
            <dx-date-box
              [inputAttr]="{ 'aria-label': 'Data da Nota' }"
              [width]="300"
              alignment="left"
              [value]="notas.data"
              displayFormat="dd/MM/yyyy">
            </dx-date-box>
          </dxi-item>
        </div>
      </div>

      <dxi-item>
        <dx-data-grid
          id="orders"
          [dataSource]="dataSource"
          [repaintChangesOnly]="true"
          [columnAutoWidth]="true"
          [showBorders]="true"
          (onRowInserted)="onRowInserted($event)">
          <dxo-paging [pageSize]="10"></dxo-paging>

          <dxo-editing
            mode="row"
            [allowAdding]="true"
            [allowUpdating]="true"
            [allowDeleting]="true">
          </dxo-editing>

          <dxi-column
            dataField="ordenacao"
            dataType="number">
          </dxi-column>

          <dxi-column
            dataField="produto"
            dataType="string">

            <dxo-lookup
              [dataSource]="dataSourceProdutos"
              valueExpr="id"
              displayExpr="descricao">
            </dxo-lookup>
          </dxi-column>

          <dxi-column
            dataField="valor_unitario"
            caption="Valor Unitário"
            dataType="number"
            [allowEditing]="false"
            [cellTemplate]="valorUnitarioTemplate">
          </dxi-column>

          <dxi-column
            dataField="quantidade"
            dataType="number">
          </dxi-column>

          <dxi-column
            dataField="valor_total"
            dataType="number"
            format="$ #.##0,#"
            [calculateCellValue]="calculateTotalValue"
            [allowSorting]="true"
            [allowEditing]="false">
          </dxi-column>

          <dxo-summary>
            <dxi-total-item
              column="Amount"
              summaryType="sum"
              displayFormat="{0}"
              valueFormat="currency">
            </dxi-total-item>
          </dxo-summary>
        </dx-data-grid>
      </dxi-item>

      </dxi-item>
  </dx-form>
</div>
